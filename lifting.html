<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tactical Barbell - Operator (3-Week Wave)</title>

  <!-- Bootstrap 5 (no React) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    .mono { font-variant-numeric: tabular-nums; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .small-note { font-size: 0.9rem; color: #6c757d; }
    .sticky-top-lite { position: sticky; top: 0; z-index: 1020; background: white; }
    .table td, .table th { vertical-align: middle; }
  </style>
</head>

<body class="bg-light">
  <div class="container py-4">

    <header class="mb-4">
      <h1 class="h3 mb-1">Tactical Barbell – Operator (6-Week Wave)</h1>
      <div class="small-note">
        Same main lifts each session (Mon/Wed/Fri) across six weeks. Adjust reference values below to recalc weights instantly.
        <ul class="mb-0 ps-4">
          <li><span class="mono">Week 1: 3–5×5 @70%</span></li>
          <li><span class="mono">Week 2: 3–5×5 @80%</span></li>
          <li><span class="mono">Week 3: 3–4×3 @90%</span></li>
          <li><span class="mono">Week 4: 3–5×5 @75%</span></li>
          <li><span class="mono">Week 5: 3–5×3 @85%</span></li>
          <li><span class="mono">Week 6: 3–4×1–2 @95%</span></li>
        </ul>
      </div>
    </header>

    <!-- SETTINGS / INPUTS -->
    <div class="card shadow-sm mb-4 sticky-top-lite">
      <div class="card-body">
        <div class="row g-3 align-items-end">
          <div class="col-12 col-lg-3">
            <label class="form-label">Squat 1RM (kg)</label>
            <input id="rmSquat" type="number" class="form-control" min="1" step="0.25" value="109">
          </div>
          <div class="col-12 col-lg-3">
            <label class="form-label">Bench 1RM (kg)</label>
            <input id="rmBench" type="number" class="form-control" min="1" step="0.25" value="82">
          </div>
          <div class="col-12 col-lg-3">
            <label class="form-label">Pull-up max reps</label>
            <input id="maxPullupReps" type="number" class="form-control" min="1" step="1" value="9">
          </div>
          <div class="col-12 col-lg-3">
            <label class="form-label">Rounding (kg)</label>
            <select id="rounding" class="form-select">
              <option value="0.5" selected>0.5 kg</option>
              <option value="1">1 kg</option>
              <option value="2.5">2.5 kg</option>
              <option value="5">5 kg</option>
              <option value="0">No rounding</option>
            </select>
          </div>

          <div class="col-12">
            <div class="d-flex flex-wrap gap-2 mt-2">
              <button id="btnReset" class="btn btn-outline-secondary btn-sm">Reset to defaults</button>
            </div>
            <div class="small-note mt-2">
              Pull-ups are shown as bodyweight sets/reps.
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- TABS -->
    <ul class="nav nav-tabs" id="weekTabs" role="tablist"></ul>

    <div class="tab-content border border-top-0 bg-white p-3 shadow-sm" id="weekTabContent"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ----------------------------
    // CONFIG (easy to alter)
    // ----------------------------
    const DEFAULTS = {
      rmSquat: 109,
      rmBench: 82,
      maxPullupReps: 9,
      rounding: 0.5
    };

    // Operator 3-week wave definition
    // You can add/remove exercises here.
    const PROGRAM = [
      { key: "squat", name: "Back Squat", type: "1rm", rmInputId: "rmSquat" },
      { key: "bench", name: "Bench Press", type: "1rm", rmInputId: "rmBench" },
      { key: "pullup", name: "Pull-up (Bodyweight)", type: "bw_reps", repsInputId: "maxPullupReps" }
    ];

    // Week prescriptions (strength)
    // For 1RM lifts: percent + sets/reps.
    // For BW pull-ups: sets + repTargetPct of max reps (matched to weight % for simplicity).
    const WEEKS = [
      { id: 1, name: "Week 1", percent: 0.70, sets: "3–5", reps: "5",  pullupRepTargetPct: 0.70 },
      { id: 2, name: "Week 2", percent: 0.80, sets: "3–5", reps: "5",  pullupRepTargetPct: 0.80 },
      { id: 3, name: "Week 3", percent: 0.90, sets: "3–4", reps: "3",  pullupRepTargetPct: 0.90 },
      { id: 4, name: "Week 4", percent: 0.75, sets: "3–5", reps: "5",  pullupRepTargetPct: 0.75 },
      { id: 5, name: "Week 5", percent: 0.85, sets: "3–5", reps: "3",  pullupRepTargetPct: 0.85 },
      { id: 6, name: "Week 6", percent: 0.95, sets: "3–4", reps: "1–2", pullupRepTargetPct: 0.95 }
    ];

    // ----------------------------
    // Helpers
    // ----------------------------
    function roundToStep(value, step) {
      if (!step || step === 0) return value;
      return Math.round(value / step) * step;
    }

    function fmtKg(x) {
      // avoid trailing .0 if integer
      const rounded = Math.round(x * 10) / 10;
      return (Number.isInteger(rounded) ? String(rounded) : rounded.toFixed(1)) + " kg";
    }

    function safeInt(x, fallback) {
      const n = parseInt(x, 10);
      return Number.isFinite(n) ? n : fallback;
    }

    function safeFloat(x, fallback) {
      const n = parseFloat(x);
      return Number.isFinite(n) ? n : fallback;
    }

    function getSettingsFromInputs() {
      return {
        rmSquat: safeFloat(document.getElementById("rmSquat").value, DEFAULTS.rmSquat),
        rmBench: safeFloat(document.getElementById("rmBench").value, DEFAULTS.rmBench),
        maxPullupReps: safeInt(document.getElementById("maxPullupReps").value, DEFAULTS.maxPullupReps),
        rounding: safeFloat(document.getElementById("rounding").value, DEFAULTS.rounding)
      };
    }

    function setInputsFromSettings(s) {
      document.getElementById("rmSquat").value = s.rmSquat;
      document.getElementById("rmBench").value = s.rmBench;
      document.getElementById("maxPullupReps").value = s.maxPullupReps;
      document.getElementById("rounding").value = String(s.rounding);
    }

    // ----------------------------
    // Rendering
    // ----------------------------
    function buildWeekTable(week, settings) {
      const rows = PROGRAM.map(ex => {
        if (ex.type === "1rm") {
          const rm = settings[ex.rmInputId];
          const raw = rm * week.percent;
          const w = roundToStep(raw, settings.rounding);
          return `
            <tr>
              <td>${ex.name}</td>
              <td class="mono text-nowrap">${week.sets}×${week.reps}</td>
              <td class="mono text-nowrap">${fmtKg(w)}</td>
            </tr>
          `;
        }

        if (ex.type === "bw_reps") {
          const maxReps = settings[ex.repsInputId];
          const target = Math.round(maxReps * week.pullupRepTargetPct);
          return `
            <tr>
              <td>${ex.name}</td>
              <td class="mono text-nowrap">${week.sets}×${target}</td>
              <td class="mono text-nowrap">Bodyweight</td>
            </tr>
          `;
        }

        return "";
      }).join("");

      return `
        <div class="table-responsive">
          <table class="table table-striped table-hover align-middle mb-0">
            <thead>
              <tr>
                <th style="width: 35%">Exercise</th>
                <th style="width: 20%">Sets×Reps</th>
                <th style="width: 45%">Weight</th>
              </tr>
            </thead>
            <tbody>${rows}</tbody>
          </table>
        </div>
      `;
    }

    function buildTabs() {
      const tabs = WEEKS.map((week, idx) => `
        <li class="nav-item" role="presentation">
          <button class="nav-link ${idx === 0 ? "active" : ""}" id="week${week.id}-tab" data-bs-toggle="tab" data-bs-target="#week${week.id}" type="button" role="tab">
            Week ${week.id}
          </button>
        </li>
      `).join("");

      const panels = WEEKS.map((week, idx) => `
        <div class="tab-pane fade ${idx === 0 ? "show active" : ""}" id="week${week.id}" role="tabpanel" aria-labelledby="week${week.id}-tab">
          <h2 class="h5 mb-3">${week.name} — <span class="mono">${week.sets}×${week.reps} @${Math.round(week.percent * 100)}%</span></h2>
          <div id="week${week.id}Table"></div>
        </div>
      `).join("");

      document.getElementById("weekTabs").innerHTML = tabs;
      document.getElementById("weekTabContent").innerHTML = panels;
    }

    function renderAll() {
      const settings = getSettingsFromInputs();

      // basic validation guardrails
      if (settings.rmSquat <= 0) settings.rmSquat = DEFAULTS.rmSquat;
      if (settings.rmBench <= 0) settings.rmBench = DEFAULTS.rmBench;
      if (settings.maxPullupReps <= 0) settings.maxPullupReps = DEFAULTS.maxPullupReps;

      WEEKS.forEach(week => {
        const container = document.getElementById(`week${week.id}Table`);
        if (container) container.innerHTML = buildWeekTable(week, settings);
      });
    }

    function resetDefaults() {
      setInputsFromSettings(DEFAULTS);
    }

    // ----------------------------
    // Wire up events
    // ----------------------------
    ["rmSquat", "rmBench", "maxPullupReps", "rounding"].forEach(id => {
      document.getElementById(id).addEventListener("input", renderAll);
      document.getElementById(id).addEventListener("change", renderAll);
    });

    document.getElementById("btnReset").addEventListener("click", () => {
      resetDefaults();
      renderAll();
    });

    // Initial load: tabs + defaults
    buildTabs();
    resetDefaults();
    renderAll();
  </script>
</body>
</html>
